(function(h,f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define(f):h.lemonade=f()})(this,function(){var h={isDOM:function(f){return f instanceof Element||f instanceof HTMLDocument},render:function(f,k,m){if(!h.isDOM(k))return console.log("DOM element given is not valid"),!1;m||(m={});h.isDOM(f)||(h.isClass(f)?f=(new f).create():"function"==typeof f&&(f=f(m)));k.appendChild(f);h.queue(f);return f},queue:function(f){if(f.self&&f.self.queue)for(var k;k=
f.self.queue.shift();)k.onload()},blender:function(f,k,m){return h.render(h.element(f,k),m,k)},apply:function(f,k){h.template(f,k);h.queue(f)}};h.template=function(){var f=function(a,c){var d=c[a]||"",e=function(){if(c.tracking[a])for(var b=0;b<c.tracking[a].length;b++){var g=eval(c.tracking[a][b].v);"innerHTML"==c.tracking[a][b].property?c.tracking[a][b].element.innerHTML=g:"textContent"==c.tracking[a][b].property?c.tracking[a][b].element.textContent=g:"value"==c.tracking[a][b].property?c.tracking[a][b].element.value!=
g&&(c.tracking[a][b].element.value=g,"function"==typeof c.tracking[a][b].element.change&&c.tracking[a][b].element.change(g)):"checked"==c.tracking[a][b].property?"radio"==c.tracking[a][b].element.type?(c.tracking[a][b].element.checked=!1,c.tracking[a][b].element.value==g&&(c.tracking[a][b].element.checked=!0)):c.tracking[a][b].element.checked=g?!0:!1:c.tracking[a][b].element.setAttribute(c.tracking[a][b].property,g)}};Array.isArray(c[a])?Array.prototype.refresh=e:Object.defineProperty(c,a,{set:function(b){c.state[a]=
b;e(b)},get:function(){return c.state[a]}});c[a]=d;c.tracking[a]=[]},k=function(a,c,d,e){var b=c.v.match(/self\.([a-zA-Z0-9_].*?)*/g);if(b.length){var g=eval(c.v)||"";if("textContent"==d){var l=document.createTextNode(g);a.childNodes[0]?a.insertBefore(l,a.childNodes[0].splitText(c.p)):a.appendChild(l)}else l=a,l[d]=g;if(l)for(a=0;a<b.length;a++)g=b[a].replace("self.",""),e.tracking[g]||f(g,e),e.tracking[g].push({element:l,property:d,v:c.v})}},m=function(a,c,d,e){var b=[],g=0;a.getAttribute&&a.getAttribute(d)?
a.setAttribute(d,a.getAttribute(d).replace(/\{\{(.*?)\}\}/g,function(l,n,p,r){b.push({p:p-g,v:n});g+=l.length;return""})):"string"==typeof a[d]&&a[d]&&(a[d]=a[d].replace(/\{\{(.*?)\}\}/g,function(l,n,p,r){b.push({p:p-g,v:n});g+=l.length;return""}));if(b.length)for(1!=b.length||"textContent"!=d||a.innerText||(d="innerHTML"),c=b.length-1;0<=c;c--)k(a,b[c],d,e)},q=function(a,c){var d={};if(a.attributes&&a.attributes.length)for(var e=0;e<a.attributes.length;e++)d[a.attributes[e].name]=a.attributes[e].value;
var b=Object.keys(d);if(b.length)for(e=0;e<b.length;e++)if("on"==b[e].substring(0,2)){var g=b[e].toLowerCase(),l=d[b[e]];a.removeAttribute(g);a.events||(a.events=[]);a.events[g.substring(2)]=l;a[g]=function(n){eval(this.events[n.type])}}else a.events||(a.events=[]),"@ready"==b[e]?(c.queue.push(a),a.events.load=d[b[e]],a.onload=function(n){eval(this.events.load)},a.removeAttribute(b[e])):"@ref"==b[e]?(eval(d[b[e]]+" = element"),a.removeAttribute(b[e])):"@bind"==b[e]?(a.onchange=function(n){eval(this.events.change)},
"checkbox"==a.type?(a.events.change=d[b[e]]+" = this.checked",g="checked"):"radio"==a.type?(a.events.change=d[b[e]]+" = this.value;",g="checked"):(a.events.change=d[b[e]]+" = this.value",g="value"),k(a,{v:d[b[e]]},g,c),a.removeAttribute(b[e])):m(a,d[b[e]],b[e],c);if(a.children.length)for(e=0;e<a.children.length;e++)q(a.children[e],c);else m(a,"innerText","textContent",c);if(a.constructor==HTMLUnknownElement&&(d=a.tagName,d=d.charAt(0).toUpperCase()+d.slice(1).toLowerCase(),d=eval(d),"function"==typeof d)){b=
"true"==a.getAttribute("extended")?c:{};for(e=0;e<a.attributes.length;e++)b[a.attributes[e].name]=a.attributes[e].value;h.render(d,a,b)}};return function(a,c){c||(c={});c.state||(c.state={});c.tracking||(c.tracking={});c.queue=[];if(h.isDOM(a))d=a;else{var d=document.createElement("div");d.innerHTML=a.trim();1==d.childNodes.length&&(d=d.childNodes[0])}q(d,c);d.self=c;return d}}();h.element=h.template;h.isClass=function(f){return"function"===typeof f&&/^class\s/.test(Function.prototype.toString.call(f))};
h.component=function(){};h.component.prototype.create=function(){var f=h.element(this.render(),this);if("function"==typeof this.onload)this.onload(f,this);return f};return h});