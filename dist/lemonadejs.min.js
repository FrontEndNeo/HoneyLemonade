(function(h,g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define(g):h.lemonade=g()})(this,function(){var h={render:function(g,k,m){if(!(k instanceof Element||k instanceof HTMLDocument))return console.log("DOM element given is not valid"),!1;m||(m={});g instanceof Element||g instanceof HTMLDocument?k.appendChild(g):g=h.isClass(g)?(new g).create():g(m);k.appendChild(g);if(g.self&&g.self.queue)for(;k=g.self.queue.shift();)k.onload();
return g},blender:function(g,k,m){return h.render(h.element(g,k),m,k)}};h.element=function(){var g=function(a,c){var e=c[a]||"",d=function(){if(c.tracking[a])for(var b=0;b<c.tracking[a].length;b++){var f=eval(c.tracking[a][b].v);"html"==c.tracking[a][b].property?c.tracking[a][b].element.innerHTML=f:"textContent"==c.tracking[a][b].property?c.tracking[a][b].element.textContent=f:"value"==c.tracking[a][b].property?"function"==typeof c.tracking[a][b].element.change?c.tracking[a][b].element.value!=f&&
c.tracking[a][b].element.change(f):c.tracking[a][b].element.value=f:"checked"==c.tracking[a][b].property?"radio"==c.tracking[a][b].element.type?(c.tracking[a][b].element.checked=!1,c.tracking[a][b].element.value==f&&(c.tracking[a][b].element.checked=!0)):c.tracking[a][b].element.checked=f?!0:!1:c.tracking[a][b].element.setAttribute(c.tracking[a][b].property,f)}};Array.isArray(c[a])?Array.prototype.refresh=d:Object.defineProperty(c,a,{set:function(b){c.state[a]=b;d(b)},get:function(){return c.state[a]}});
c[a]=e;c.tracking[a]=[]},k=function(a,c,e,d){var b=c.v.match(/self\.([a-zA-Z0-9_].*?)*/g);if(b.length){var f=eval(c.v);if("textContent"==e){var l=document.createTextNode(f);a.childNodes[0]?a.insertBefore(l,a.childNodes[0].splitText(c.p)):a.appendChild(l)}else l=a,l[e]=f;if(l)for(a=0;a<b.length;a++)f=b[a].replace("self.",""),d.tracking[f]||g(f,d),d.tracking[f].push({element:l,property:e,v:c.v})}},m=function(a,c,e,d){var b=[],f=0;a.getAttribute&&a.getAttribute(e)?a.setAttribute(e,a.getAttribute(e).replace(/\{\{(.*?)\}\}/g,
function(l,n,p,r){b.push({p:p-f,v:n});f+=l.length;return""})):"string"==typeof a[e]&&(a[e]=a[e].replace(/\{\{(.*?)\}\}/g,function(l,n,p,r){b.push({p:p-f,v:n});f+=l.length;return""}));if(b.length)for(c=b.length-1;0<=c;c--)k(a,b[c],e,d)},q=function(a,c){var e={};if(a.attributes&&a.attributes.length)for(var d=0;d<a.attributes.length;d++)e[a.attributes[d].name]=a.attributes[d].value;var b=Object.keys(e);if(b.length)for(d=0;d<b.length;d++)if("on"==b[d].substring(0,2)){var f=b[d].toLowerCase(),l=e[b[d]];
a.removeAttribute(f);a.events||(a.events=[]);a.events[f.substring(2)]=l;a[f]=function(n){eval(this.events[n.type])}}else a.events||(a.events=[]),"@ready"==b[d]?(c.queue.push(a),a.events.load=e[b[d]],a.onload=function(n){eval(this.events.load)},a.removeAttribute(b[d])):"@ref"==b[d]?(eval(e[b[d]]+" = element"),a.removeAttribute(b[d])):"@bind"==b[d]?(a.onchange=function(n){eval(this.events.change)},"checkbox"==a.type?(a.events.change=e[b[d]]+" = this.checked",f="checked"):"radio"==a.type?(a.events.change=
e[b[d]]+" = this.value;",f="checked"):(a.events.change=e[b[d]]+" = this.value",f="value"),k(a,{v:e[b[d]]},f,c),a.removeAttribute(b[d])):m(a,e[b[d]],b[d],c);if(a.children.length)for(d=0;d<a.children.length;d++)q(a.children[d],c);else m(a,"innerText","textContent",c);if(a.constructor==HTMLUnknownElement&&(e=a.tagName,e=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),e=eval(e),"function"==typeof e)){b="true"==a.getAttribute("extended")?c:{};for(d=0;d<a.attributes.length;d++)b[a.attributes[d].name]=
a.attributes[d].value;h.isClass(e)?(d=new e,a.appendChild(d.create())):a.appendChild(e(b))}};return function(a,c){c||(c={});c.state||(c.state={});c.tracking||(c.tracking={});c.queue=[];var e=document.createElement("div");e.innerHTML=a.trim();1==e.childNodes.length&&(e=e.childNodes[0]);q(e,c);e.self=c;return e}}();h.isClass=function(g){return"function"===typeof g&&/^class\s/.test(Function.prototype.toString.call(g))};h.component=function(){};h.component.prototype.create=function(){var g=h.element(this.render(),
this);if("function"==typeof this.onload)this.onload(g,this);return g};return h});