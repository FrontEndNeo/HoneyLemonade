(function(l,g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define(g):l.lemonade=g()})(this,function(){var l={render:function(g,h,m){if(!(h instanceof Element||h instanceof HTMLDocument))return console.log("DOM element given is not valid"),!1;m||(m={});g instanceof Element||g instanceof HTMLDocument?h.appendChild(g):l.isClass(g)?(g=new g,h.appendChild(g.create())):h.appendChild(g(m));if(m&&m.queue)for(h=0;h<m.queue.length;h++)m.queue[h].onload();
return g}};l.element=function(){var g=function(a,d){var e=d[a]||"",c=function(){if(d.tracking[a])for(var b=0;b<d.tracking[a].length;b++){var f=eval(d.tracking[a][b].v);"html"==d.tracking[a][b].property?d.tracking[a][b].element.innerHTML=f:"textContent"==d.tracking[a][b].property?d.tracking[a][b].element.textContent=f:"value"==d.tracking[a][b].property?"function"==typeof d.tracking[a][b].element.change?d.tracking[a][b].element.value!=f&&d.tracking[a][b].element.change(f):d.tracking[a][b].element.value=
f:"checked"==d.tracking[a][b].property?"radio"==d.tracking[a][b].element.type?(d.tracking[a][b].element.checked=!1,d.tracking[a][b].element.value==f&&(d.tracking[a][b].element.checked=!0)):d.tracking[a][b].element.checked=f?!0:!1:d.tracking[a][b].element.setAttribute(d.tracking[a][b].property,f)}};Array.isArray(d[a])?Array.prototype.refresh=c:Object.defineProperty(d,a,{set:function(b){d.state[a]=b;c(b)},get:function(){return d.state[a]}});d[a]=e;d.tracking[a]=[]},h=function(a,d,e,c){var b=d.v.match(/self\.([a-zA-Z0-9_].*?)*/g);
if(b.length){var f=eval(d.v);if("textContent"==e){var k=document.createTextNode(f);a.childNodes[0]?a.insertBefore(k,a.childNodes[0].splitText(d.p)):a.appendChild(k)}else"undefined"!==typeof a[e]&&(k=a,k[e]=f);if(k)for(a=0;a<b.length;a++)f=b[a].replace("self.",""),c.tracking[f]||g(f,c),c.tracking[f].push({element:k,property:e,v:d.v})}},m=function(a,d,e,c){var b=[],f=0;a.getAttribute&&a.getAttribute(e)?a.setAttribute(e,a.getAttribute(e).replace(/\{\{(.*?)\}\}/g,function(k,n,p,r){b.push({p:p-f,v:n});
f+=k.length;return""})):"string"==typeof a[e]&&(a[e]=a[e].replace(/\{\{(.*?)\}\}/g,function(k,n,p,r){b.push({p:p-f,v:n});f+=k.length;return""}));if(b.length)for(d=b.length-1;0<=d;d--)h(a,b[d],e,c)},q=function(a,d){var e={};if(a.attributes.length)for(var c=0;c<a.attributes.length;c++)e[a.attributes[c].name]=a.attributes[c].value;var b=Object.keys(e);if(b.length)for(c=0;c<b.length;c++)if("on"==b[c].substring(0,2)){var f=b[c].toLowerCase(),k=e[b[c]];a.removeAttribute(f);a.events||(a.events=[]);a.events[f.substring(2)]=
k;a[f]=function(n){eval(this.events[n.type])}}else a.events||(a.events=[]),"@ready"==b[c]?(d.queue.push(a),a.events.load=e[b[c]],a.onload=function(n){eval(this.events.load)},a.removeAttribute(b[c])):"@ref"==b[c]?(eval(e[b[c]]+" = element"),a.removeAttribute(b[c])):"@bind"==b[c]?(a.onchange=function(n){eval(this.events.change)},"checkbox"==a.type?(a.events.change=e[b[c]]+" = this.checked",f="checked"):"radio"==a.type?(a.events.change=e[b[c]]+" = this.value;",f="checked"):(a.events.change=e[b[c]]+" = this.value",
f="value"),h(a,{p:0,v:e[b[c]]},f,d),a.removeAttribute(b[c])):m(a,e[b[c]],b[c],d);if(a.children.length)for(c=0;c<a.children.length;c++)q(a.children[c],d);else m(a,"innerText","textContent",d);if(a.constructor==HTMLUnknownElement&&(e=a.tagName,e=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),e=eval(e),"function"==typeof e)){b="true"==a.getAttribute("extended")?d:{};for(c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c].value;l.isClass(e)?(c=new e,a.appendChild(c.create())):a.appendChild(e(b))}};
return function(a,d){var e=d?d:{};e.state||(e.state={});e.tracking||(e.tracking={});e.queue=[];var c=document.createElement("div");c.innerHTML=a.trim();1==c.children.length&&(c=c.children[0]);q(1<c.children.length?c:c.children[0],e);return c}}();l.isClass=function(g){return"function"===typeof g&&/^class\s/.test(Function.prototype.toString.call(g))};l.component=function(){};l.component.prototype.create=function(){var g=l.element(this.render(),this);if("function"==typeof this.onload)this.onload(g,this);
return g};return l});